---
modules:
  - type: dnf
    repos:
      cleanup: false

      # Add the COSMIC Epoch COPR repo for Fedora 42
      copr:
        - ryanabx/cosmic-epoch

    remove:
      packages:
        # Remove GNOME components that conflict with COSMIC
        - gnome-shell
        - gnome-session
        - gnome-control-center
        - gnome-terminal
        - gnome-shell-extension*
        - mutter

    install:
      packages:
        # Core COSMIC packages
        - cosmic-desktop
        - cosmic-session
        - cosmic-settings
        - cosmic-greeter
        - cosmic-apps

        # Optional: System76 utilities
        - system76-power
        - system76-driver

  # --- Set display manager and session defaults ---
  - type: systemd
    enable:
      - cosmic-greeter.service
    disable:
      - gdm.service
    set-default: graphical.target